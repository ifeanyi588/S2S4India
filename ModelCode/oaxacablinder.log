
. 
. glo path "D:\Poverty_Estimates_India"

. glo pathout "D:\Poverty_Estimates_India\IndiaModelRuns"

. 
. glo data  "$path\data\replication" //contains input data

. glo data2  "$pathout\data\replication" //contains input data

. 
. glo analysis  "$pathout\analysis" //all these are output datasets, the result of "analysis"

. 
. global ruralvars "Dagecat1h Dagecat1 Dagecat2 Dagecat2h Dagecat3 Dagecat3h Dagecat4h Dagecat4 Dagecat5" 

. global ruralvars "${ruralvars} hhsizeh hhsize highskillocc highskillocch" 

. global ruralvars "${ruralvars} middleskillocc middleskillocch indh agri agrih scst scsth selfemployed selfemployedh" 

. global ruralvars "${ruralvars} depratio depratioh hhage"

. global ruralvars "${ruralvars} Dmarriedh Dmarried" 

. global ruralvars "${ruralvars} Dmaleh Dmale" 

. global ruralvars "${ruralvars} Dfirewood Ddungcakeh Ddungcake Dnocookingh Dnocooking Dcokecoal"

. global ruralvars "${ruralvars} Dkerosene Delectricityh Delectricity Dcharcoal Dlpg Dlpgh"  

. global ruralvars "${ruralvars} rainfallQ1 rainfallQ2 rainfallQ3 rainfallQ4"

. global ruralvars "${ruralvars} rainfallQ1sq rainfallQ2sq rainfallQ3sq"

. 
. global urbanvars "Dagecat1h Dagecat1 Dagecat2 Dagecat2h Dagecat3 Dagecat3h Dagecat4h Dagecat5 Dagecat5h" 

. global urbanvars "${urbanvars} hhsizeh hhsize highskillocc highskillocch" 

. global urbanvars "${urbanvars} middleskillocch indh agrih agri scsth selfemployedh" 

. global urbanvars "${urbanvars} regwageurban regwageurbanh depratio"

. global urbanvars "${urbanvars} Dmarriedh Dmaleh hhage" 

. global urbanvars "${urbanvars} Dfirewood Dfirewoodh Ddungcakeh Ddungcake Dnocookingh Dnocooking Dcokecoalh Dkeroseneh"

. global urbanvars "${urbanvars} Dkerosene Delectricityh Delectricity Dcharcoal Dcharcoalh Dlpg"  

. global urbanvars "${urbanvars} rainfallQ1 rainfallQ3 rainfallQ4"

. global urbanvars "${urbanvars} rainfallQ1sq rainfallQ2sq rainfallQ3sq rainfallQ4sq"

.                    
.                            
. 
. ****Code to estimate the drivers of the difference between predictions in 2011 and 2018
. 
. use "$path\data\finaldata\oaxaca_rural.dta", clear 
(Written by R)

. 
. reg lnwelf $ruralvars [pw = pop_wgt] if year == 2011
(sum of wgt is 791,982,350.22921)

Linear regression                               Number of obs     =     59,501
                                                F(48, 59452)      =     181.45
                                                Prob > F          =     0.0000
                                                R-squared         =     0.3379
                                                Root MSE          =     .41455

---------------------------------------------------------------------------------
                |               Robust
      lnwelfare |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
      Dagecat1h |  -.3455536   .0352848    -9.79   0.000    -.4147119   -.2763953
       Dagecat1 |  -1.025432   .1983739    -5.17   0.000    -1.414245   -.6366179
       Dagecat2 |  -.8638261    .408935    -2.11   0.035     -1.66534   -.0623118
      Dagecat2h |  -.1572501   .0303108    -5.19   0.000    -.2166594   -.0978408
       Dagecat3 |  -1.121502   .4023533    -2.79   0.005    -1.910116   -.3328881
      Dagecat3h |   .0600551   .0290037     2.07   0.038     .0032078    .1169025
      Dagecat4h |    .129825    .022806     5.69   0.000     .0851252    .1745248
       Dagecat4 |  -1.282261   .4251001    -3.02   0.003    -2.115459    -.449063
       Dagecat5 |  -.5580664   .4311634    -1.29   0.196    -1.403148    .2870155
        hhsizeh |  -.0281529   .0029154    -9.66   0.000    -.0338671   -.0224386
         hhsize |   .0170926   .0072221     2.37   0.018     .0029373    .0312479
   highskillocc |  -.4701983   .0646451    -7.27   0.000    -.5969029   -.3434937
  highskillocch |   .1132139   .0123557     9.16   0.000     .0889968    .1374311
 middleskillocc |  -.5435645    .080153    -6.78   0.000    -.7006647   -.3864642
middleskillocch |   .0363879   .0135204     2.69   0.007     .0098879    .0628879
           indh |  -.0747887   .0101351    -7.38   0.000    -.0946535    -.054924
           agri |  -.3634327   .0360715   -10.08   0.000     -.434133   -.2927324
          agrih |  -.0734454   .0101168    -7.26   0.000    -.0932745   -.0536164
           scst |  -.0905499   .0202474    -4.47   0.000    -.1302349    -.050865
          scsth |  -.1137018   .0084672   -13.43   0.000    -.1302974   -.0971061
   selfemployed |   .1227917   .0327906     3.74   0.000      .058522    .1870615
  selfemployedh |   .1125518   .0071507    15.74   0.000     .0985363    .1265672
       depratio |  -.1305011    .352291    -0.37   0.711    -.8209928    .5599905
      depratioh |  -.1481614    .024148    -6.14   0.000    -.1954915   -.1008313
          hhage |  -.0004402   .0004842    -0.91   0.363    -.0013892    .0005088
      Dmarriedh |   .0145009     .01357     1.07   0.285    -.0120963    .0410981
       Dmarried |   .1103028   .1243684     0.89   0.375    -.1334597    .3540654
         Dmaleh |  -.0060937   .0153093    -0.40   0.691    -.0360999    .0239125
          Dmale |  -.0602891   .1094856    -0.55   0.582    -.2748813    .1543031
      Dfirewood |  -.2729778   .0593984    -4.60   0.000    -.3893989   -.1565568
     Ddungcakeh |   .0340551   .0128337     2.65   0.008     .0089009    .0592092
      Ddungcake |  -.2485401   .0691148    -3.60   0.000    -.3840054   -.1130748
    Dnocookingh |   .5981708   .0753178     7.94   0.000     .4505476    .7457941
     Dnocooking |  -.8402443   .3098157    -2.71   0.007    -1.447484   -.2330042
      Dcokecoal |   -.334831   .0822165    -4.07   0.000    -.4959757   -.1736864
      Dkerosene |  -1.395588   .2103265    -6.64   0.000    -1.807829   -.9833476
  Delectricityh |   .4564289   .1100634     4.15   0.000     .2407043    .6721535
   Delectricity |  -.2841058   .8952214    -0.32   0.751    -2.038743    1.470532
      Dcharcoal |  -1.604495    1.19506    -1.34   0.179    -3.946817    .7378268
           Dlpg |   .1597098   .0662904     2.41   0.016     .0297804    .2896392
          Dlpgh |   .2956762    .009799    30.17   0.000       .27647    .3148823
     rainfallQ1 |  -.1235347   .0089122   -13.86   0.000    -.1410027   -.1060667
     rainfallQ2 |   .0403712    .009007     4.48   0.000     .0227175    .0580249
     rainfallQ3 |  -.0148659   .0148326    -1.00   0.316    -.0439378    .0142059
     rainfallQ4 |   .1734745   .0122711    14.14   0.000     .1494231    .1975258
   rainfallQ1sq |   .0654728   .0127431     5.14   0.000     .0404963    .0904492
   rainfallQ2sq |  -.1191174   .0153204    -7.78   0.000    -.1491455   -.0890893
   rainfallQ3sq |   .1025281   .0135499     7.57   0.000     .0759702    .1290859
          _cons |   6.153964   .4109511    14.97   0.000     5.348498     6.95943
---------------------------------------------------------------------------------

. predict yhatrural 
(option xb assumed; fitted values)

. 
. oaxaca yhatrural $ruralvars [pw = pop_wgt], by(year) pooled relax nose

Blinder-Oaxaca decomposition                    Number of obs     =    117,539
                                                  Model           =     linear
Group 1: year = 2011                              N of obs 1      =      59501
Group 2: year = 2017                              N of obs 2      =      58038

---------------------------------------------------------------------------------
      yhatrural |      Coef.
----------------+----------------------------------------------------------------
overall         |
        group_1 |   4.399079
        group_2 |   4.723283
     difference |  -.3242042
      explained |  -.3242041
    unexplained |  -7.12e-09
----------------+----------------------------------------------------------------
explained       |
      Dagecat1h |  -.0186572
       Dagecat1 |  -.0534921
       Dagecat2 |   .0187905
      Dagecat2h |   .0039142
       Dagecat3 |   .0142452
      Dagecat3h |   -.000947
      Dagecat4h |  -.0010149
       Dagecat4 |   .0060411
       Dagecat5 |   .0106855
        hhsizeh |  -.0020439
         hhsize |   .0111661
   highskillocc |   .0068316
  highskillocch |  -.0009464
 middleskillocc |  -.0010628
middleskillocch |   .0001609
           indh |   .0006471
           agri |  -.0001118
          agrih |   .0016141
           scst |   .0015142
          scsth |   .0017761
   selfemployed |  -.0006595
  selfemployedh |  -.0026916
       depratio |  -.0017386
      depratioh |  -.0030547
          hhage |   .0002508
      Dmarriedh |  -.0000821
       Dmarried |   .0009122
         Dmaleh |   .0001205
          Dmale |  -.0000562
      Dfirewood |  -.0573994
     Ddungcakeh |   .0020572
      Ddungcake |  -.0089937
    Dnocookingh |   .0007184
     Dnocooking |  -.0001388
      Dcokecoal |  -.0026177
      Dkerosene |  -.0134562
  Delectricityh |   .0001198
   Delectricity |  -.0001105
      Dcharcoal |   .0010588
           Dlpg |  -.0456663
          Dlpgh |  -.0775412
     rainfallQ1 |  -.0086956
     rainfallQ2 |  -.0228748
     rainfallQ3 |  -.0021727
     rainfallQ4 |  -.1117563
   rainfallQ1sq |  -.0061256
   rainfallQ2sq |   .0296827
   rainfallQ3sq |   .0075962
----------------+----------------------------------------------------------------
unexplained     |
      Dagecat1h |   4.78e-09
       Dagecat1 |  -2.96e-08
       Dagecat2 |  -1.37e-08
      Dagecat2h |   1.31e-09
       Dagecat3 |  -1.48e-08
      Dagecat3h |  -2.20e-10
      Dagecat4h |   5.82e-10
       Dagecat4 |  -2.08e-08
       Dagecat5 |  -1.39e-09
        hhsizeh |  -2.91e-09
         hhsize |  -3.00e-08
   highskillocc |   4.71e-09
  highskillocch |   4.69e-10
 middleskillocc |   2.85e-09
middleskillocch |  -3.45e-10
           indh |  -3.54e-10
           agri |  -2.18e-09
          agrih |   3.85e-09
           scst |  -1.11e-08
          scsth |   9.53e-10
   selfemployed |   3.78e-11
  selfemployedh |   3.48e-10
       depratio |   1.87e-08
      depratioh |   5.59e-10
          hhage |  -8.69e-09
      Dmarriedh |  -5.87e-09
       Dmarried |  -3.11e-08
         Dmaleh |   6.12e-09
          Dmale |   7.45e-08
      Dfirewood |   1.76e-09
     Ddungcakeh |  -3.60e-10
      Ddungcake |   1.75e-09
    Dnocookingh |   1.42e-10
     Dnocooking |   3.68e-10
      Dcokecoal |  -2.79e-10
      Dkerosene |   8.46e-10
  Delectricityh |   2.40e-11
   Delectricity |  -3.55e-10
      Dcharcoal |   1.87e-10
           Dlpg |  -1.50e-08
          Dlpgh |  -7.63e-10
     rainfallQ1 |  -2.26e-09
     rainfallQ2 |  -4.55e-10
     rainfallQ3 |  -3.76e-09
     rainfallQ4 |  -5.22e-10
   rainfallQ1sq |   6.01e-10
   rainfallQ2sq |   2.07e-09
   rainfallQ3sq |   8.99e-10
          _cons |   6.12e-08
---------------------------------------------------------------------------------

. estimates save "${analysis}/oaxaca_rural", replace
file D:\Poverty_Estimates_India\IndiaModelRuns\analysis/oaxaca_rural.ster saved

. 
. use "$path\data\finaldata\oaxaca_urban.dta", clear 
(Written by R)

. 
. reg lnwelf $urbanvars [pw = pop_wgt] if year == 2011
(sum of wgt is 316,736,829.34263)

Linear regression                               Number of obs     =     41,706
                                                F(46, 41659)      =     216.19
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4437
                                                Root MSE          =     .48315

---------------------------------------------------------------------------------
                |               Robust
      lnwelfare |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
----------------+----------------------------------------------------------------
      Dagecat1h |  -.5690016   .0555201   -10.25   0.000    -.6778223    -.460181
       Dagecat1 |   -.995268   .2048289    -4.86   0.000    -1.396737   -.5937991
       Dagecat2 |    .579323   .2287815     2.53   0.011     .1309066    1.027739
      Dagecat2h |  -.2610281   .0510343    -5.11   0.000    -.3610563   -.1609998
       Dagecat3 |   .6805339   .1930939     3.52   0.000     .3020658    1.059002
      Dagecat3h |  -.0601639   .0445373    -1.35   0.177     -.147458    .0271301
      Dagecat4h |   .0589142   .0411396     1.43   0.152    -.0217203    .1395487
       Dagecat5 |   .7615899   .2264904     3.36   0.001     .3176641    1.205516
      Dagecat5h |   .0294286   .0387896     0.76   0.448    -.0465999    .1054571
        hhsizeh |  -.0534105   .0039556   -13.50   0.000    -.0611636   -.0456575
         hhsize |   -.019517   .0099262    -1.97   0.049    -.0389725   -.0000615
   highskillocc |  -.1416747   .0722895    -1.96   0.050    -.2833637    .0000143
  highskillocch |   .3219565   .0122578    26.27   0.000     .2979311     .345982
middleskillocch |   .0630419   .0131376     4.80   0.000      .037292    .0887917
           indh |  -.0426737   .0099738    -4.28   0.000    -.0622227   -.0231248
          agrih |   .1120452   .0222719     5.03   0.000     .0683918    .1556985
           agri |  -.3481803   .0394184    -8.83   0.000    -.4254412   -.2709193
          scsth |  -.1773673   .0110514   -16.05   0.000    -.1990283   -.1557063
  selfemployedh |  -.0504104   .0124649    -4.04   0.000    -.0748419    -.025979
   regwageurban |   .5953663   .0876722     6.79   0.000      .423527    .7672056
  regwageurbanh |   .0874624   .0121487     7.20   0.000     .0636507    .1112742
       depratio |   1.461467   .2408766     6.07   0.000     .9893439     1.93359
      Dmarriedh |   .0254475   .0168235     1.51   0.130    -.0075269    .0584219
         Dmaleh |   .0178213   .0184115     0.97   0.333    -.0182656    .0539083
          hhage |  -.0012465   .0008096    -1.54   0.124    -.0028333    .0003403
      Dfirewood |    .115718   .0659757     1.75   0.079    -.0135958    .2450318
     Dfirewoodh |  -.3384943   .0125997   -26.87   0.000      -.36319   -.3137986
     Ddungcakeh |  -.2202509   .0356132    -6.18   0.000    -.2900535   -.1504482
      Ddungcake |   .3068121   .0741975     4.14   0.000     .1613833    .4522408
    Dnocookingh |   .2635798   .0389815     6.76   0.000     .1871752    .3399843
     Dnocooking |   .8462766   .4129758     2.05   0.040     .0368355    1.655718
     Dcokecoalh |  -.3597204   .0233575   -15.40   0.000    -.4055017   -.3139392
     Dkeroseneh |  -.2539095   .0209075   -12.14   0.000    -.2948887   -.2129304
      Dkerosene |  -.1849796   .1584472    -1.17   0.243    -.4955395    .1255803
  Delectricityh |   .0310304   .0823848     0.38   0.706    -.1304455    .1925064
   Delectricity |  -.5764062   .7514636    -0.77   0.443    -2.049291    .8964782
      Dcharcoal |  -4.526643   2.030057    -2.23   0.026    -8.505597   -.5476894
     Dcharcoalh |  -.2269063   .1007942    -2.25   0.024    -.4244651   -.0293476
           Dlpg |   -.031668   .0756765    -0.42   0.676    -.1799954    .1166595
     rainfallQ1 |  -.0381727   .0118075    -3.23   0.001    -.0613157   -.0150298
     rainfallQ3 |  -.0376375   .0208607    -1.80   0.071    -.0785249    .0032499
     rainfallQ4 |   .0993613   .0232591     4.27   0.000     .0537729    .1449496
   rainfallQ1sq |   .0855289   .0223849     3.82   0.000      .041654    .1294038
   rainfallQ2sq |  -.0804731   .0275858    -2.92   0.004    -.1345419   -.0264042
   rainfallQ3sq |   .1027338    .021102     4.87   0.000     .0613734    .1440941
   rainfallQ4sq |  -.0166264   .0272537    -0.61   0.542    -.0700442    .0367914
          _cons |   4.881206   .1372702    35.56   0.000     4.612154    5.150259
---------------------------------------------------------------------------------

. predict yhaturban 
(option xb assumed; fitted values)

. 
. oaxaca yhaturban $urbanvars [pw = pop_wgt], by(year) pooled relax nose

Blinder-Oaxaca decomposition                    Number of obs     =     83,855
                                                  Model           =     linear
Group 1: year = 2011                              N of obs 1      =      41706
Group 2: year = 2017                              N of obs 2      =      42149

---------------------------------------------------------------------------------
      yhaturban |      Coef.
----------------+----------------------------------------------------------------
overall         |
        group_1 |   4.737947
        group_2 |   4.950617
     difference |    -.21267
      explained |    -.21267
    unexplained |   6.05e-11
----------------+----------------------------------------------------------------
explained       |
      Dagecat1h |  -.0233824
       Dagecat1 |  -.0529915
       Dagecat2 |  -.0090154
      Dagecat2h |   .0011695
       Dagecat3 |   -.008037
      Dagecat3h |   .0009303
      Dagecat4h |  -.0007533
       Dagecat5 |  -.0177218
      Dagecat5h |  -.0004304
        hhsizeh |  -.0047825
         hhsize |  -.0134718
   highskillocc |   .0050356
  highskillocch |   -.015507
middleskillocch |  -.0004625
           indh |   .0006157
          agrih |   .0000115
           agri |  -.0030032
          scsth |   .0033213
  selfemployedh |   .0010513
   regwageurban |  -.0376241
  regwageurbanh |  -.0012877
       depratio |   .0199106
      Dmarriedh |  -.0000691
         Dmaleh |  -.0000462
          hhage |   .0010406
      Dfirewood |   .0208321
     Dfirewoodh |  -.0337688
     Ddungcakeh |  -.0022679
      Ddungcake |    .009419
    Dnocookingh |   .0032699
     Dnocooking |   .0021653
     Dcokecoalh |  -.0058858
     Dkeroseneh |  -.0101351
      Dkerosene |  -.0075485
  Delectricityh |   .0000738
   Delectricity |   -.000499
      Dcharcoal |   .0012117
     Dcharcoalh |  -.0000693
           Dlpg |   .0085639
     rainfallQ1 |   .0077877
     rainfallQ3 |  -.0083994
     rainfallQ4 |  -.0641444
   rainfallQ1sq |  -.0076918
   rainfallQ2sq |   .0143296
   rainfallQ3sq |    .012051
   rainfallQ4sq |   .0035356
----------------+----------------------------------------------------------------
unexplained     |
      Dagecat1h |   7.31e-10
       Dagecat1 |  -4.86e-10
       Dagecat2 |   2.84e-08
      Dagecat2h |   1.01e-09
       Dagecat3 |   7.48e-09
      Dagecat3h |  -3.53e-10
      Dagecat4h |   4.60e-10
       Dagecat5 |  -2.80e-09
      Dagecat5h |   1.05e-09
        hhsizeh |   3.13e-09
         hhsize |  -2.38e-08
   highskillocc |  -9.19e-11
  highskillocch |   2.25e-09
middleskillocch |   1.37e-10
           indh |   5.67e-10
          agrih |   3.69e-10
           agri |  -6.32e-09
          scsth |   4.88e-09
  selfemployedh |  -3.55e-09
   regwageurban |   5.16e-09
  regwageurbanh |   1.83e-09
       depratio |   2.08e-08
      Dmarriedh |  -3.55e-10
         Dmaleh |  -4.96e-09
          hhage |  -3.42e-09
      Dfirewood |  -1.67e-08
     Dfirewoodh |   2.05e-10
     Ddungcakeh |  -2.32e-10
      Ddungcake |  -2.05e-09
    Dnocookingh |  -2.87e-10
     Dnocooking |  -1.90e-09
     Dcokecoalh |  -3.96e-10
     Dkeroseneh |  -3.84e-10
      Dkerosene |  -2.36e-09
  Delectricityh |  -1.26e-11
   Delectricity |  -3.32e-10
      Dcharcoal |   1.68e-10
     Dcharcoalh |   1.39e-11
           Dlpg |  -3.75e-08
     rainfallQ1 |  -1.19e-09
     rainfallQ3 |   6.90e-09
     rainfallQ4 |   3.24e-09
   rainfallQ1sq |  -2.10e-09
   rainfallQ2sq |  -1.82e-10
   rainfallQ3sq |  -3.23e-09
   rainfallQ4sq |  -4.97e-09
          _cons |   3.11e-08
---------------------------------------------------------------------------------

. estimates save "${analysis}/oaxaca_urban", replace
(note: file D:\Poverty_Estimates_India\IndiaModelRuns\analysis/oaxaca_urban.ster not found)
file D:\Poverty_Estimates_India\IndiaModelRuns\analysis/oaxaca_urban.ster saved

. 
. 
. cap log close
